# ××¨×›×™×˜×§×˜×•×¨×” ××•××œ×¦×ª ×œ×ª××œ×•×œ ××•×“×™×•

## ğŸ—ï¸ ××‘× ×” ×”××¢×¨×›×ª

### 1. ×œ×§×•×— (Client) - ×¤×©×•×˜ ×•× ×§×™
```
ğŸ“± Mobile/Web App
â”œâ”€â”€ ğŸ“¤ File Upload (drag & drop)
â”œâ”€â”€ ğŸ“Š Progress Bar
â”œâ”€â”€ ğŸ”„ Real-time Status
â””â”€â”€ ğŸ“ Results Display
```

### 2. ×©×¨×ª (Next.js API Routes)
```
ğŸ–¥ï¸ Next.js Server
â”œâ”€â”€ ğŸ“¥ /api/upload - ×§×‘×œ×ª ×§×‘×¦×™×
â”œâ”€â”€ ğŸ”„ /api/status/[id] - ××¢×§×‘ ×”×ª×§×“××•×ª
â”œâ”€â”€ ğŸ“ /api/webhook - ×§×‘×œ×ª ×ª×•×¦××•×ª
â””â”€â”€ ğŸ“‹ /api/results/[id] - ×ª×•×¦××•×ª ×¡×•×¤×™×•×ª
```

### 3. ×¢×™×‘×•×“ (Supabase Edge Functions)
```
â˜ï¸ Supabase Edge Functions
â”œâ”€â”€ ğŸµ Audio Processing
â”‚   â”œâ”€â”€ FFmpeg - ×”××¨×” ×•×¤×™×¦×•×œ
â”‚   â”œâ”€â”€ Duration Detection
â”‚   â””â”€â”€ Segment Creation
â”œâ”€â”€ ğŸ’¾ Storage Management
â””â”€â”€ ğŸ—„ï¸ Database Updates
```

### 4. ×ª××œ×•×œ (ElevenLabs)
```
ğŸ™ï¸ ElevenLabs Scribe API
â”œâ”€â”€ ğŸ“¤ Segment Upload
â”œâ”€â”€ ğŸ”„ Async Processing
â”œâ”€â”€ ğŸ“ Webhook Notifications
â””â”€â”€ ğŸ“ Transcription Results
```

## ğŸ”„ ×–×¨×™××ª ×”×¢×‘×•×“×”

### ×©×œ×‘ 1: ×”×¢×œ××”
1. ××©×ª××© ×‘×•×—×¨ ×§×•×‘×¥ ××•×“×™×•
2. ×”×¢×œ××” ×œ-Supabase Storage
3. ×™×¦×™×¨×ª ××©×™××” ×‘××¡×“ × ×ª×•× ×™×
4. ×”×—×–×¨×ª Task ID ×œ×œ×§×•×—

### ×©×œ×‘ 2: ×¢×™×‘×•×“
1. Edge Function ××•×¨×™×“ ××ª ×”×§×•×‘×¥
2. ×–×™×”×•×™ ××©×š ×•×¤×•×¨××˜
3. ×¤×™×¦×•×œ ×œ×§×˜×¢×™× (15 ×“×§×•×ª ×›×œ ××—×“)
4. ×”×¢×œ××ª ×§×˜×¢×™× ×œ-Storage
5. ×¢×“×›×•×Ÿ ××¡×“ × ×ª×•× ×™×

### ×©×œ×‘ 3: ×ª××œ×•×œ
1. ×©×œ×™×—×ª ×›×œ ×§×˜×¢ ×œ-ElevenLabs
2. ×§×‘×œ×ª webhook ×¢×‘×•×¨ ×›×œ ×§×˜×¢
3. ×¢×“×›×•×Ÿ ×”×ª×§×“××•×ª ×‘××¡×“ × ×ª×•× ×™×
4. ×”×¨×›×‘×ª ×ª××œ×•×œ ×¡×•×¤×™

### ×©×œ×‘ 4: ×ª×•×¦××•×ª
1. ×”×•×“×¢×” ×œ×œ×§×•×— ×¢×œ ×”×©×œ××”
2. ×”×¦×’×ª ×ª××œ×•×œ ××œ×
3. ××¤×©×¨×•×ª ×œ×”×•×¨×“×”
4. × ×™×§×•×™ ×§×‘×¦×™× ×–×× ×™×™×

## ğŸ’¡ ×™×ª×¨×•× ×•×ª ×”×’×™×©×”

### ×ª××™××•×ª ××œ××”
- ×¢×•×‘×“ ×¢×œ ×›×œ ×“×¤×“×¤×Ÿ (Chrome, Safari, Firefox)
- ×ª××™×›×” ××œ××” ×‘××•×‘×™×™×œ (iOS, Android)
- ×œ× ×“×•×¨×© Web Audio API
- ×œ× ×ª×œ×•×™ ×‘-JavaScript ××ª×§×“×

### ×‘×™×¦×•×¢×™× ××¢×•×œ×™×
- ×¢×™×‘×•×“ ××”×™×¨ ×‘×©×¨×ª
- ×œ× ××¢××™×¡ ×¢×œ ×”××›×©×™×¨
- ×”×¢×œ××” ×—×“-×¤×¢××™×ª
- ×¢×™×‘×•×“ ××§×‘×™×œ×™ ×©×œ ×§×˜×¢×™×

### ×—×•×•×™×™×ª ××©×ª××© ××¢×•×œ×”
- ×”×¢×œ××” ×¤×©×•×˜×”
- ××¢×§×‘ ×”×ª×§×“××•×ª ×‘×–××Ÿ ×××ª
- ××™×Ÿ ×”××ª× ×•×ª ××¨×•×›×•×ª
- ×ª×•×¦××•×ª ××™×™×“×™×•×ª

## ğŸ› ï¸ ××™××•×© ××•××œ×¥

### Frontend (React/Next.js)
```typescript
// ×¤×©×•×˜ ×•× ×§×™ - ×¨×§ ×”×¢×œ××” ×•××¢×§×‘
const TranscriptionApp = () => {
  const [file, setFile] = useState(null)
  const [taskId, setTaskId] = useState(null)
  const [progress, setProgress] = useState(0)
  const [result, setResult] = useState(null)
  
  // ×”×¢×œ××” ×¤×©×•×˜×”
  const uploadFile = async () => {
    const formData = new FormData()
    formData.append('file', file)
    
    const response = await fetch('/api/upload', {
      method: 'POST',
      body: formData
    })
    
    const { taskId } = await response.json()
    setTaskId(taskId)
    startPolling(taskId)
  }
  
  // ××¢×§×‘ ×”×ª×§×“××•×ª
  const startPolling = (id) => {
    const interval = setInterval(async () => {
      const status = await fetch(`/api/status/${id}`)
      const data = await status.json()
      
      setProgress(data.progress.percentage)
      
      if (data.status === 'completed') {
        setResult(data.finalTranscription)
        clearInterval(interval)
      }
    }, 3000)
  }
}
```

### Backend (Next.js API)
```typescript
// /api/upload.ts
export default async function handler(req, res) {
  // 1. ×§×‘×œ×ª ×§×•×‘×¥
  // 2. ×”×¢×œ××” ×œ-Supabase Storage
  // 3. ×™×¦×™×¨×ª ××©×™××”
  // 4. ×§×¨×™××” ×œ-Edge Function
  // 5. ×”×—×–×¨×ª Task ID
}

// /api/status/[taskId].ts
export default async function handler(req, res) {
  // 1. ×©×œ×™×¤×ª ×¡×˜×˜×•×¡ ××”××¡×“ × ×ª×•× ×™×
  // 2. ×—×™×©×•×‘ ×”×ª×§×“××•×ª
  // 3. ×”×—×–×¨×ª ××™×“×¢ ××¢×•×“×›×Ÿ
}
```

## ğŸ¯ ×œ××” ×–×” ×”×¤×ª×¨×•×Ÿ ×”×˜×•×‘ ×‘×™×•×ª×¨?

1. **×¤×©×˜×•×ª** - ×œ×§×•×— ×¤×©×•×˜, ×©×¨×ª ×¢×•×©×” ×”×›×œ
2. **×××™× ×•×ª** - ×¢×™×‘×•×“ ×™×¦×™×‘ ×‘×¢× ×Ÿ
3. **××”×™×¨×•×ª** - ×¢×™×‘×•×“ ××§×‘×™×œ×™ ×•×™×¢×™×œ
4. **×ª××™××•×ª** - ×¢×•×‘×“ ×‘×›×œ ××§×•×
5. **××“×¨×’×™×•×ª** - ×™×›×•×œ ×œ×˜×¤×œ ×‘×”×¨×‘×” ××©×ª××©×™×
6. **××‘×˜×—×”** - ×§×‘×¦×™× ××•×’× ×™× ×‘×©×¨×ª
7. **×—×•×•×™×”** - ×¤×©×•×˜ ×•× ×•×— ×œ××©×ª××©

×–×” ×‘×“×™×•×§ ××” ×©×™×© ×œ×š ×›×‘×¨ - ×¨×§ ×¦×¨×™×š ×œ×ª×§×Ÿ ××ª ×”-service role key!